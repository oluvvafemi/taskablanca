.d-flex.justify-content-between.align-items-center.mb-4
  .d-flex.align-items-center
    = link_to projects_path, class: "btn btn-outline-secondary btn-sm me-3" do
      %i.bi.bi-arrow-left
    %div
      %h1.h3.mb-1= @project.title
      %span.badge.bg-light.text-dark= @project.organization.name
  .d-flex.gap-2
    = link_to edit_project_path(@project), class: "btn btn-outline-dark" do
      %i.bi.bi-pencil.me-1
      Edit
    = button_to project_path(@project), method: :delete, class: "btn btn-outline-danger", form: { data: { turbo_confirm: "Are you sure you want to delete this project? All tasks will be deleted too." } } do
      %i.bi.bi-trash.me-1
      Delete

.card.shadow-sm.mb-4
  .card-body
    %h5.card-title Description
    %p.card-text= @project.description || "No description provided."

.d-flex.justify-content-between.align-items-center.mb-3
  %h5.mb-0
    %i.bi.bi-list-task.me-2
    Tasks
    %span.badge.bg-secondary.ms-2= @tasks.count
  = link_to new_task_path(project_id: @project.id), class: "btn btn-dark btn-sm" do
    %i.bi.bi-plus-lg.me-1
    New Task

- if @tasks.any?
  .card.shadow-sm
    .card-body
      .table-responsive
        %table.table.table-hover.align-middle.mb-0
          %thead
            %tr
              %th Task
              %th Status
              %th Assigned To
              %th Actions
          %tbody
            - @tasks.each do |task|
              %tr
                %td
                  %strong= task.title
                  %br/
                  %small.text-muted= truncate(task.description, length: 80)
                %td
                  - if task.status == "todo"
                    %span.badge.bg-secondary Todo
                  - elsif task.status == "in_progress"
                    %span.badge.bg-dark In Progress
                  - elsif task.status == "done"
                    %span.badge.bg-success Done
                %td
                  - if task.users.any?
                    = task.users.map(&:name).join(", ")
                  - else
                    %span.text-muted Unassigned
                %td
                  = link_to "View", task_path(task), class: "btn btn-sm btn-outline-dark"
- else
  .card.shadow-sm
    .card-body.text-center.py-5
      %i.bi.bi-list-task.fs-1.text-muted.mb-3
      %p.text-muted.mb-3 No tasks in this project yet.
      = link_to new_task_path(project_id: @project.id), class: "btn btn-dark" do
        %i.bi.bi-plus-lg.me-1
        Create First Task

