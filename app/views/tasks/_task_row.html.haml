%tr{ id: dom_id(task) }
  %td
    %strong= task.title
    %br/
    %small.text-muted= truncate(task.description, length: 80)
  %td
    - if task.status == "todo"
      %span.badge.bg-secondary Todo
    - elsif task.status == "in_progress"
      %span.badge.bg-dark In Progress
    - elsif task.status == "done"
      %span.badge.bg-success Done
  %td
    - if task.users.any?
      = task.users.map(&:name).join(", ")
    - else
      %span.text-muted Unassigned
  %td.text-nowrap
    .d-flex.gap-1
      = link_to task_path(task), class: "btn btn-sm btn-outline-dark", data: { turbo_frame: "_top" }, title: "View task" do
        %i.bi.bi-eye
      - if task.users.include?(Current.user)
        = link_to edit_task_path(task, project_id: task.project_id), class: "btn btn-sm btn-outline-secondary", data: { turbo_frame: "edit_task" } do
          %i.bi.bi-pencil
        = button_to task_path(task), method: :delete, class: "btn btn-sm btn-outline-danger", form: { data: { turbo_confirm: "Are you sure?" } } do
          %i.bi.bi-trash
      - else
        = link_to edit_task_path(task, project_id: task.project_id), class: "btn btn-sm btn-outline-secondary disabled", data: { turbo_frame: "edit_task" }, style: "opacity: 0.5; pointer-events: none;" do
          %i.bi.bi-pencil
        = button_to task_path(task), method: :delete, class: "btn btn-sm btn-outline-danger disabled", form: { data: { turbo_confirm: "Are you sure?" } }, style: "opacity: 0.5; pointer-events: none;" do
          %i.bi.bi-trash

